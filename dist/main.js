var d={id:"bajrangcoder.path.intellize",name:"PathIntellisense",main:"dist/main.js",version:"1.0.0",readme:"readme.md",icon:"icon.png",files:[],minVersionCode:290,price:0,author:{name:"Raunak Raj",email:"bajrangcoders@gmail.com",github:"bajrangCoder"}};var f=class{constructor(){this.cache=new Map,this.accessOrder=[]}async getAsync(e){return this.cache.has(e)?(this.accessOrder=this.accessOrder.filter(t=>t!==e),this.accessOrder.unshift(e),this.cache.get(e)):null}async setAsync(e,t){if(this.cache.size>=20){let s=this.accessOrder.pop();this.cache.delete(s)}this.cache.set(e,t),this.accessOrder.unshift(e)}},p=f;var C=acode.require("fsOperation"),v=acode.require("helpers"),{editor:g}=editorManager,m=class{constructor(){this.directoryCache=new p}async init(){let e=this;g.completers.push({getCompletions:async function(t,s,n,r,a){let o=s.getLine(n.row),i=e.getCurrentInput(o,n.column);if(!editorManager.activeFile.uri)return;let c=e.removeFileNameAndExtension(editorManager.activeFile.uri);if(i.startsWith("/")){let h=c,u=e.resolveRelativePath(h,i);await e.fetchDirectoryContents(u,a,!1)}else if(i.startsWith("../")){let h=c,u=e.resolveRelativePath(h,i);await e.fetchDirectoryContents(u,a,!1)}else if(i.startsWith("./")){let h=c,u=e.resolveRelativePath(h,i.substring(1));await e.fetchDirectoryContents(u,a,!1)}else await e.fetchDirectoryContents(c,a,!0)}}),g.commands.on("afterExec",function(t){t.command.name==="insertstring"&&t.args==="/"&&g.execCommand("startAutocomplete")})}async fetchDirectoryContents(e,t,s){try{let n=await this.directoryCache.getAsync(e);if(n){t(null,n);return}let a=(await C(e).lsDir()).map(function(o){let i=v.getIconForFile(o.name);return{caption:o.name,value:o.name,score:s?500:8e3,meta:o.isFile?"File":"Folder",icon:o.isFile?`${i}`:"icon folder"}});await this.directoryCache.setAsync(e,a),t(null,a)}catch(n){t(null,[]),console.log(n)}}getCurrentInput(e,t){let s="",n=t-1;for(;n>=0&&/[a-zA-Z0-9/.+_\-\s]/.test(e[n]);)s=e[n]+s,n--;return s}resolveRelativePath(e,t){if(t.startsWith("/"))return e+t;let s=e.split("::");if(s.length===2){let n=s[0],r=s[1];r.endsWith("/")||(r+="/");let a=t.split("/");for(let i of a)if(i===".."){let c=r.lastIndexOf("/",r.length-2);c!==-1&&(r=r.substring(0,c+1))}else i!=="."&&i!==""&&(r+=i+"/");return n+"::"+r}return e}removeFileNameAndExtension(e){let t=e.lastIndexOf("/"),s=e.substring(t+1);return e.substring(0,e.length-s.length-1)}async destroy(){}};if(window.acode){let l=new m;acode.setPluginInit(d.id,async(e,t,{cacheFileUrl:s,cacheFile:n})=>{e.endsWith("/")||(e+="/"),l.baseUrl=e,await l.init(t,n,s)}),acode.setPluginUnmount(d.id,()=>{l.destroy()})}
